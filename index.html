
<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BESIX Connect â€“ Webapp</title>
  <link rel="icon" href="/favicon.ico?v=3" type="image/x-icon">
  <style>
    :root{ --sidebar-w: 260px; --sidebar-bg:#f4f6f8; --sidebar-hover:#e9eef3; --accent:#3b82f6; --accent-weak:#dbeafe; --text:#1f2937; --muted:#6b7280; --border:#e5e7eb; --header-h:56px; }
    *{box-sizing:border-box} html,body{height:100%} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;color:var(--text);}
    .app{display:grid;grid-template-columns:var(--sidebar-w) 1fr;grid-template-rows:var(--header-h) 1fr;grid-template-areas:"sidebar header" "sidebar main";height:100vh}
    header{grid-area:header;display:flex;align-items:center;gap:12px;padding:0 12px;border-bottom:1px solid var(--border)}
    aside{grid-area:sidebar;background:var(--sidebar-bg);border-right:1px solid var(--border);padding:10px 8px;overflow:auto}
    main{grid-area:main}
    .section-title{font-size:12px;letter-spacing:.06em;text-transform:uppercase;color:var(--muted);margin:10px 12px 6px}
    .nav{display:flex;flex-direction:column;gap:4px;padding:0 4px}
    .nav-btn{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;color:var(--text);text-decoration:none;cursor:pointer}
    .nav-btn:hover{background:var(--sidebar-hover)}
    .nav-btn.active{background:var(--accent-weak);outline:1px solid var(--accent)}
    #contentFrame{width:100%;height:calc(100vh - var(--header-h));border:0}
  </style>
</head>
<body>
  <div class="app">
    <aside>
      <div class="section-title">Navigatie</div>
      <nav class="nav" id="nav">
        <a class="nav-btn active" data-url="Map1.html">Kaartview</a>
        <a class="nav-btn" data-url="pages/projecten.html">Projectenlijst</a>
      </nav>
    </aside>

    <header>
      <strong>BESIX Connect</strong>
      <div style="margin-left:auto;">
        <a href="/.auth/logout?post_logout_redirect_uri=/login">Uitloggen</a>
      </div>
    </header>

    <main>
      <iframe id="contentFrame" src="Map1.html" title="Content"></iframe>
    </main>
  </div>

  <script>
    // Side nav switching
    const frame=document.getElementById('contentFrame');
    document.getElementById('nav').addEventListener('click',e=>{
      const btn=e.target.closest('.nav-btn'); if(!btn) return; e.preventDefault();
      document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      const url=btn.getAttribute('data-url'); if(url) frame.src=url;
    });

    // Receive navigation requests from child pages (e.g., projecten.html)
    window.addEventListener('message', (ev)=>{
      if (!ev || !ev.data) return;
      if (ev.data.type === 'goto-map' && ev.data.werfnr) {
        frame.src = 'Map1.html?werfnr=' + encodeURIComponent(ev.data.werfnr);
        // also set active state to map
        document.querySelectorAll('.nav-btn').forEach(b=>{
          b.classList.toggle('active', b.getAttribute('data-url')==='Map1.html');
        });
      }
    });
  </script>
</body>
</html>
